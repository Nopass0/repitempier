"use client";

import { useEffect, useRef, useState } from "react";
import { Button } from "./ui/button";

export default function Promo({ className }: { className?: string }) {
  const [timer, setTimer] = useState<string>("23:59");
  const banner = useRef<HTMLDivElement | null>(null);

  useEffect(() => {
    const intervalId = setInterval(() => {
      //start of day hour: 00 , minute: 00

      const start = new Date(); // Текущее время
      start.setHours(23, 59, 0);

      // Уменьшаем время на 1 минуту
      start.setMinutes(start.getMinutes() - 1);

      const hours = start.getHours();
      const minutes = start.getMinutes();

      setTimer(
        `${hours.toString().padStart(2, "0")}:${minutes
          .toString()
          .padStart(2, "0")}`
      );
    }, 60000); // Изменено на 60000 мс (1 минута)
    return () => clearInterval(intervalId);
  }, []);

  return (
    <div
      ref={banner}
      className={
        className +
        "h-[64px] w-full flex flex-row items-center justify-center bg-[#8B3DDB]"
      }
    >
      <div className="h-full w-[1440px] mx-auto flex items-center flex-row">
        <div className="mx-auto flex items-center flex-row">
          <svg
            rotate={-22}
            width="67"
            height="64"
            viewBox="0 0 67 64"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M55.0082 16.3914C54.9701 16.2266 54.8368 16.0863 54.6584 16.0548L43.7626 14.1108L66.069 -11.2554C66.1837 -11.378 66.2076 -11.5383 66.1439 -11.6924C66.0801 -11.8465 65.95 -11.9431 65.7972 -11.9851L39.1388 -16.0404C38.9785 -16.0644 38.8244 -16.0006 38.7204 -15.8523L13.8748 18.9714C13.7783 19.1016 13.7725 19.2694 13.8438 19.4054C13.9151 19.5413 14.0453 19.6378 14.2056 19.6618L28.5472 20.9923L3.92415 53.2274C3.78687 53.4045 3.81297 53.6494 3.9644 53.7973C4.11583 53.9452 4.3638 53.9629 4.54048 53.8447L54.8607 16.7983C54.9891 16.7451 55.0463 16.5561 55.0082 16.3914ZM6.45483 51.3833L29.6976 20.9375C29.7942 20.8073 29.8181 20.647 29.7543 20.4929C29.6906 20.3388 29.5604 20.2423 29.3926 20.2365L15.0146 18.8909L39.284 -15.1079L64.9005 -11.2081L42.6091 14.1218C42.4944 14.2444 42.4705 14.4047 42.5342 14.5588C42.5798 14.7054 42.7206 14.8276 42.8628 14.844L53.5257 16.734L6.45483 51.3833Z"
              fill="#282864"
            />
            <path
              d="M29.705 20.9193C29.8015 20.7892 29.8255 20.6289 29.7617 20.4748C29.698 20.3207 29.5678 20.2241 29.4 20.2184L15.022 18.8728L39.2914 -15.126L64.9079 -11.2262L42.6089 14.1218C42.4943 14.2444 42.4703 14.4047 42.5341 14.5588C42.5797 14.7054 42.7205 14.8276 42.8626 14.844L53.5255 16.734L6.48035 51.3727L29.705 20.9193Z"
              fill="#FFD150"
            />
          </svg>
          <div className="ml-[33px] flex flex-col text-left">
            <p className="text-white text-[16px] font-semibold">
              Скидки 40% до конца октября
            </p>
            <div className="text-white text-[14px] font-medium flex flex-row items-center">
              По промокоду{" "}
              <p className="px-2 ml-[5px] py-1 rounded-md text-[12px] text-[#8B3DDB] bg-white flex flex-row w-[68px] h-[22px] text-center items-center justify-center font-semibold">
                «ЛЕТО»
              </p>
            </div>
          </div>
          <div className="ml-[55px] flex flex-row items-center gap-x-1">
            <div className="flex flex-row items-center gap-x-0.5">
              <p className="rounded-[8px] text-[16px] font-semibold bg-white w-[29px] h-[32px] items-center text-center py-1 justify-center text-[#8B3DDB] px-2">
                {timer[0]}
              </p>
              <p className="rounded-[8px] text-[16px] font-semibold bg-white w-[29px] h-[32px] items-center justify-center text-center py-1 text-[#8B3DDB] px-2">
                {timer[1]}
              </p>
            </div>
            <p className="text-white text-[16px] ">:</p>
            <div className="flex flex-row items-center gap-x-0.5">
              <p className="rounded-[8px] text-[16px] font-semibold bg-white w-[29px] h-[32px] items-center justify-center text-center py-1 text-[#8B3DDB] px-2">
                {timer[3]}
              </p>
              <p className="rounded-[8px] text-[16px] font-semibold bg-white w-[29px] h-[32px] items-center justify-center text-center py-1 text-[#8B3DDB] px-2">
                {timer[4]}
              </p>
            </div>
          </div>
          <Button className="w-[115px] h-[34px] font-semibold text-[13px] ml-[11px]">
            Подробнее
          </Button>
          <svg
            className="ml-[31px]"
            rotate={21}
            width="90"
            height="62"
            viewBox="0 0 90 62"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M30.0005 46.475L34.7315 58.4548C34.7315 58.4548 30.7919 56.3322 26.5764 54.607C22.361 52.8818 18.5203 53.7494 17.1349 57.1816L16.984 57.5297C15.7874 60.5267 16.8783 64.5676 20.5322 66.5146C24.1861 68.4615 34.5797 75.9692 40.4509 80.791C46.9674 86.1514 51.7695 90.4578 51.7695 90.4578L82.1558 78.4579C82.1558 78.4579 82.8838 71.5348 81.7138 65.6498C80.2989 58.7796 79.8833 56.9964 77.2468 50.3201L71.0981 34.9332L68.9405 35.4969L30.0005 46.475Z"
              fill="#F1F1FF"
            />
            <path
              d="M83.4607 79.385L51.5145 92.0009L50.8691 91.4624C50.8444 91.4 46.0047 87.1806 39.5752 81.858C33.6794 76.9738 23.3348 69.5909 19.855 67.7195C15.3685 65.308 14.2939 60.3951 15.704 57.0253L15.8549 56.6772C16.5476 54.9611 17.774 53.6835 19.3716 52.9804C21.5308 52.0556 24.2337 52.1422 26.9942 53.2879C28.8844 54.0561 30.6497 54.8736 32.0916 55.6025L28.1491 45.6193L68.5734 34.1993L71.928 33.3793L78.4956 49.8269C81.1436 56.715 81.5839 58.5606 82.9988 65.4308C84.2181 71.4406 83.49 78.3637 83.4638 78.6625L83.4607 79.385ZM52.0888 88.8891L80.9775 77.4806C81.148 75.538 81.3952 70.3195 80.4306 65.868C79.0404 59.0602 78.6116 57.4264 76.0375 50.7255L70.3325 36.4617L69.2848 36.7311L31.7668 47.2921L37.3109 61.3309L34.0921 59.5727C34.0675 59.5103 30.1526 57.4501 26.0488 55.8251C23.8976 54.9436 21.9172 54.8602 20.4197 55.4516C19.4214 55.8458 18.7203 56.6276 18.3296 57.6474L18.1786 57.9954C17.284 60.2961 17.9546 63.6376 21.1487 65.3334C24.8026 67.2803 35.1471 74.6631 41.2662 79.7477C46.4295 84.0557 50.5746 87.6118 52.0888 88.8891Z"
              fill="#282864"
            />
            <path
              d="M78.6761 53.9388L71.0407 33.8739C69.8826 30.9414 66.4882 29.469 63.4933 30.6517C60.4983 31.8344 59.0013 35.1664 60.184 38.1614L61.1696 40.6572L78.6761 53.9388Z"
              fill="#F1F1FF"
            />
            <path
              d="M79.1701 55.1871C78.4838 55.4581 77.7005 55.1183 77.4294 54.432L69.794 34.3671C68.9069 32.1209 66.3205 31.0506 64.0119 31.9623C61.7033 32.874 60.5461 35.4227 61.4578 37.7313L62.4434 40.2271C62.7145 40.9135 62.3747 41.6968 61.6883 41.9678C61.002 42.2389 60.2187 41.8991 59.9476 41.2127L58.962 38.7169C57.5329 35.098 59.345 30.9203 63.0263 29.4665C66.7076 28.0127 70.8607 29.7626 72.3145 33.4439L79.9499 53.5088C80.1963 54.1328 79.8565 54.916 79.1701 55.1871Z"
              fill="#282864"
            />
            <path
              d="M64.0289 42.0521L60.0125 31.8817C58.8544 28.9492 55.4601 27.4767 52.4651 28.6595C49.4701 29.8422 47.973 33.1743 49.1557 36.1692L51.1516 41.2232L64.0289 42.0521Z"
              fill="#F1F1FF"
            />
            <path
              d="M64.5222 43.3006C63.8358 43.5717 63.0525 43.2319 62.7815 42.5456L58.7651 32.3752C57.878 30.129 55.267 28.9964 52.9584 29.9081C50.6498 30.8198 49.4924 33.3685 50.4041 35.6771L52.3999 40.7311C52.671 41.4174 52.3312 42.2007 51.6449 42.4718C50.9585 42.7428 50.1752 42.403 49.9042 41.7167L47.9083 36.6627C46.4791 33.0438 48.2915 28.866 51.9728 27.4123C55.6541 25.9585 59.8071 27.7083 61.2609 31.3896L65.2773 41.5599C65.5483 42.2463 65.2085 43.0296 64.5222 43.3006Z"
              fill="#282864"
            />
            <path
              d="M53.723 43.1657L48.8688 30.874C47.7107 27.9414 44.3163 26.469 41.3214 27.6517C38.3264 28.8344 36.8294 32.1664 38.0122 35.1614L41.585 44.2087L53.723 43.1657Z"
              fill="#F1F1FF"
            />
            <path
              d="M54.2153 44.4138C53.5289 44.6849 52.7456 44.3451 52.4746 43.6588L47.6204 31.367C46.7333 29.1208 44.1223 27.9881 41.8137 28.8998C39.5051 29.8115 38.3478 32.3602 39.2595 34.6688L42.8324 43.716C43.1035 44.4024 42.7637 45.1857 42.0773 45.4568C41.391 45.7278 40.6077 45.388 40.3366 44.7017L36.7638 35.6544C35.3346 32.0355 37.1468 27.8578 40.8281 26.404C44.5094 24.9502 48.6624 26.7001 50.1162 30.3814L54.9703 42.6731C55.2414 43.3595 54.9016 44.1428 54.2153 44.4138Z"
              fill="#282864"
            />
            <path
              d="M42.8758 44.9249L32.5268 18.7191C31.2455 15.4745 27.5901 13.8888 24.3455 15.1702C21.101 16.4515 19.5154 20.1069 20.7967 23.3514L35.9259 61.6619L42.8758 44.9249Z"
              fill="#F1F1FF"
            />
            <path
              d="M36.3567 62.9339C35.6703 63.205 34.887 62.8652 34.616 62.1788L19.4867 23.8684C17.9344 19.9375 19.8598 15.4987 23.7907 13.9464C27.7216 12.394 32.1605 14.3195 33.7128 18.2503L44.0618 44.4562C44.3328 45.1425 43.993 45.9258 43.3067 46.1969C42.6204 46.4679 41.837 46.1281 41.566 45.4418L31.217 19.236C30.2067 16.6778 27.3345 15.4319 24.7763 16.4422C22.2181 17.4524 20.9723 20.3246 21.9825 22.8827L37.1118 61.1932C37.3828 61.8796 37.1054 62.6382 36.3567 62.9339Z"
              fill="#282864"
            />
          </svg>
        </div>
      </div>
      <svg
        className=" absolute right-[60px] cursor-pointer"
        onClick={() => (banner.current!.style.display = "none")}
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18"
          stroke="#FCFCFC"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    </div>
  );
}
